---
layout: default
---

<article class="restaurant-detail">
  <div class="restaurant-header" style="background-image: url('{{ page.image }}');">
    <div class="restaurant-header-content">
      <h1>{{ page.title }}</h1>
      <div class="restaurant-meta">
        <div class="rating">
          {% assign rating = page.note | plus: 0.0 %}
          <span class="stars">
            {% for i in (1..5) %}
              {% if rating >= i %}
                <i class="fas fa-star"></i>
              {% elsif rating >= i | minus: 0.5 %}
                <i class="fas fa-star-half-alt"></i>
              {% else %}
                <i class="far fa-star"></i>
              {% endif %}
            {% endfor %}
          </span>
          <span class="score">{{ rating }}/5</span>
        </div>
        <span class="style"><i class="fas fa-utensils"></i> {{ page.style }}</span>
        <span class="date"><i class="far fa-calendar"></i> {{ page.date | date: "%d/%m/%Y" }}</span>
        <span class="price">
          {% if page.price == "budget" %}
            <i class="fas fa-dollar-sign"></i>
          {% elsif page.price == "medium" %}
            <i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i>
          {% elsif page.price == "expensive" %}
            <i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i>
          {% endif %}
        </span>
      </div>
    </div>
  </div>

  <div class="restaurant-content">
    <div class="restaurant-description">
      <p>{{ page.description }}</p>
    </div>

    <div class="restaurant-body">
      {{ content }}
    </div>

    {% if page.images %}
    <div class="restaurant-gallery">
      <h2>Galerie photos</h2>
      <div class="gallery-grid">
        {% for image in page.images %}
        <div class="gallery-item" onclick="openModal(this)">
          <img src="{{ image.image }}" alt="{{ page.title }}" loading="lazy">
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
</article>

<!-- Navigation buttons -->
<div class="restaurant-navigation">
  {% assign posts = site.posts | where: "layout", "restaurant" | sort: "date" | reverse %}
  {% for post in posts %}
    {% if post.url == page.url %}
      {% assign current_index = forloop.index0 %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign next_index = current_index | plus: 1 %}
      
      {% if prev_index >= 0 %}
        {% assign prev_post = posts[prev_index] %}
        <a href="{{ prev_post.url }}" class="nav-button prev">
          <i class="fas fa-arrow-left"></i>
          <span>{{ prev_post.title }}</span>
        </a>
      {% endif %}
      
      {% if next_index < posts.size %}
        {% assign next_post = posts[next_index] %}
        <a href="{{ next_post.url }}" class="nav-button next">
          <span>{{ next_post.title }}</span>
          <i class="fas fa-arrow-right"></i>
        </a>
      {% endif %}
    {% endif %}
  {% endfor %}
</div>

<!-- Modal -->
<div id="imageModal" class="modal">
  <span class="close" onclick="closeModal()">&times;</span>
  <img id="modalImage" src="" alt="Image en grand format">
</div>

<a href="{{ '/' | relative_url }}" class="back-button" onclick="storeRestaurantId(event)">
  <i class="fas fa-arrow-left"></i>
  <span>Retour</span>
</a>

<script>
  // Store the scroll position when leaving the page
  window.addEventListener('beforeunload', function() {
    sessionStorage.setItem('scrollPosition', window.scrollY);
  });

  // Store restaurant ID before redirecting
  function storeRestaurantId(event) {
    event.preventDefault();
    const restaurantId = '{{ page.title | slugify }}';
    localStorage.setItem('lastViewedRestaurant', restaurantId);
    window.location.href = "{{ '/' | relative_url }}";
  }

  // Modal functionality
  function openModal(element) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    modal.style.display = "flex";
    modalImg.src = element.querySelector('img').src;
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    const modal = document.getElementById('imageModal');
    modal.style.display = "none";
    document.body.style.overflow = 'auto';
  }

  // Close modal when clicking outside the image
  window.onclick = function(event) {
    const modal = document.getElementById('imageModal');
    if (event.target == modal) {
      closeModal();
    }
  }

  // Close modal with Escape key
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeModal();
    }
  });
</script>

<style>
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.9);
  justify-content: center;
  align-items: center;
}

.modal img {
  max-width: 90%;
  max-height: 90vh;
  object-fit: contain;
  border-radius: 4px;
}

.close {
  position: absolute;
  top: 15px;
  right: 35px;
  color: #f1f1f1;
  font-size: 40px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover {
  color: #bbb;
}

.gallery-item {
  cursor: pointer;
  transition: transform 0.3s ease;
  height: 250px;
  width: 100%;
  overflow: hidden;
  position: relative;
}

.gallery-item:hover {
  transform: scale(1.05);
}

.gallery-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center 25%;
  position: absolute;
  top: 0;
  left: 0;
}

.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 1.5rem;
  padding: 1rem 0;
}

.restaurant-navigation {
  display: flex;
  justify-content: space-between;
  margin-top: 2rem;
  gap: 1rem;
}

.nav-button {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem 1.5rem;
  background: var(--white);
  color: var(--primary-color);
  text-decoration: none;
  border-radius: 8px;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  flex: 1;
  max-width: 300px;
}

.nav-button.prev {
  justify-content: flex-start;
}

.nav-button.next {
  justify-content: flex-end;
}

.nav-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  background: var(--primary-color);
  color: var(--white);
}

.nav-button i {
  font-size: 1.2rem;
}

.nav-button span {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

@media (max-width: 768px) {
  .restaurant-navigation {
    flex-direction: column;
    gap: 1rem;
  }

  .nav-button {
    max-width: 100%;
    justify-content: center;
  }
}
</style>