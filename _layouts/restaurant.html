---
layout: default
comments: true
---

<link rel="stylesheet" href="{{ '/assets/css/restaurant.css' | relative_url }}">

<article class="restaurant-detail">
  <div class="restaurant-header" style="background-image: url('{{ page.image }}');">
    <div class="restaurant-header-content">
      <h1>{{ page.title }}</h1>
      <div class="restaurant-location">
        <i class="fas fa-map-marker-alt"></i>
        <span>{{ page.address }}</span>
      </div>
      <div class="restaurant-meta">
        <div class="rating">
          <div class="rating-bar">
            <div class="rating-fill" data-rating="{{ page.note }}"></div>
          </div>
          <span class="score">{{ page.note }}/10</span>
        </div>

        <div class="quick-ratings">
          {% if page.ratings.food %}
          <span class="quick-rating-item">
            <i class="fas fa-utensils"></i> {{ page.ratings.food.score }}/10
          </span>
          {% endif %}
          {% if page.ratings.service %}
          <span class="quick-rating-item">
            <i class="fas fa-concierge-bell"></i> {{ page.ratings.service.score }}/10
          </span>
          {% endif %}
          {% if page.ratings.value %}
          <span class="quick-rating-item">
            <i class="fas fa-coins"></i> {{ page.ratings.value.score }}/10
          </span>
          {% endif %}
        </div>

        {% if page.ratings.overall %}
        <div class="quick-rating-summary">
          <i class="fas fa-star"></i>
          <span>{{ page.ratings.overall.comment }}</span>
        </div>
        {% endif %}

        <div class="restaurant-info">
          <span class="style"><i class="fas fa-utensils"></i> {{ page.style }}</span>
          {% if page.diet %}
          <span class="diet-type">
            {% if page.diet == "vegetarian" %}
            <i class="fas fa-carrot"></i> 100% Végétarien
            {% elsif page.diet == "vegan" %}
            <i class="fas fa-leaf"></i> 100% Végétalien
            {% elsif page.diet == "vegetarian-friendly" %}
            <i class="fas fa-carrot"></i> Options végétariennes
            {% elsif page.diet == "vegan-friendly" %}
            <i class="fas fa-leaf"></i> Options végétaliennes
            {% endif %}
          </span>
          {% endif %}
          <span class="date"><i class="far fa-calendar"></i> {{ page.date | date: "%d/%m/%Y" }}</span>
          <span class="price">
            {% if page.price == "budget" %}
              <i class="fas fa-dollar-sign"></i> Budget
            {% elsif page.price == "medium" %}
              <i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i> Moyen
            {% elsif page.price == "expensive" %}
              <i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i><i class="fas fa-dollar-sign"></i> Élevé
            {% endif %}
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="restaurant-content">
    <div class="restaurant-description">
      <p>{{ page.description }}</p>
    </div>

    <div class="restaurant-body">
      {{ content }}
    </div>

    {% if page.images %}
    <div class="restaurant-gallery">
      <h2>Galerie photos</h2>
      <div class="gallery-grid">
        {% for image in page.images %}
        <div class="gallery-item" onclick="openModal(this)">
          <img src="{{ image.image }}" alt="{{ page.title }}" loading="lazy">
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>

  {% if page.ratings %}
  <div class="ratings-section">
    <h2>Pourquoi cette note ?</h2>
    
    {% for rating in page.ratings %}
    {% assign category = rating[0] %}
    {% assign details = rating[1] %}
    <div class="rating-category">
      <h3>
        <span class="rating-title">
          {% case category %}
          {% when 'food' %}
            <i class="fas fa-utensils"></i> Qualité de la nourriture
          {% when 'service' %}
            <i class="fas fa-concierge-bell"></i> Service
          {% when 'ambiance' %}
            <i class="fas fa-music"></i> Ambiance
          {% when 'value' %}
            <i class="fas fa-coins"></i> Rapport qualité/prix
          {% when 'originality' %}
            <i class="fas fa-lightbulb"></i> Originalité / Concept
          {% when 'overall' %}
            <i class="fas fa-star"></i> Expérience globale
          {% endcase %}
        </span>
      </h3>
      
      {% if details.criteria %}
      <p class="criteria"><em>{{ details.criteria }}</em></p>
      {% endif %}
      
      <p class="comment">{{ details.comment }}</p>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Section Commentaires -->
  <div class="comments-section">
    <h2>Commentaires</h2>
    <div id="disqus_thread"></div>
  </div>
</div>

<!-- Navigation buttons -->
<div class="restaurant-navigation">
  {% assign posts = site.posts | where: "layout", "restaurant" | sort: "date" | reverse %}
  {% for post in posts %}
    {% if post.url == page.url %}
      {% assign current_index = forloop.index0 %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign next_index = current_index | plus: 1 %}
      
      {% if prev_index >= 0 %}
        {% assign prev_post = posts[prev_index] %}
        <a href="{{ prev_post.url }}" class="nav-button prev">
          <i class="fas fa-arrow-left"></i>
          <span>{{ prev_post.title }}</span>
        </a>
      {% endif %}
      
      {% if next_index < posts.size %}
        {% assign next_post = posts[next_index] %}
        <a href="{{ next_post.url }}" class="nav-button next">
          <span>{{ next_post.title }}</span>
          <i class="fas fa-arrow-right"></i>
        </a>
      {% endif %}
    {% endif %}
  {% endfor %}
</div>

<!-- Modal -->
<div id="imageModal" class="modal">
  <span class="close" onclick="closeModal()">&times;</span>
  <button class="nav-arrow prev" onclick="changeImage(-1)">
    <i class="fas fa-chevron-left"></i>
  </button>
  <img id="modalImage" src="" alt="Image en grand format">
  <button class="nav-arrow next" onclick="changeImage(1)">
    <i class="fas fa-chevron-right"></i>
  </button>
</div>

<a href="{{ '/' | relative_url }}" class="back-button" onclick="storeRestaurantId(event)">
  <i class="fas fa-arrow-left"></i>
  <span>Retour</span>
</a>

<script>
  // Store the scroll position when leaving the page
  window.addEventListener('beforeunload', function() {
    sessionStorage.setItem('scrollPosition', window.scrollY);
  });

  // Store restaurant ID before redirecting
  function storeRestaurantId(event) {
    event.preventDefault();
    const restaurantId = '{{ page.title | slugify }}';
    localStorage.setItem('lastViewedRestaurant', restaurantId);
    window.location.href = "{{ '/' | relative_url }}";
  }

  let currentImageIndex = 0;
  const galleryImages = [];

  function openModal(element) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    modal.style.display = "flex";
    
    // Récupérer toutes les images de la galerie
    const galleryItems = document.querySelectorAll('.gallery-item img');
    galleryImages.length = 0; // Vider le tableau
    galleryItems.forEach(img => galleryImages.push(img.src));
    
    // Trouver l'index de l'image cliquée
    const clickedImage = element.querySelector('img');
    currentImageIndex = galleryImages.indexOf(clickedImage.src);
    
    modalImg.src = clickedImage.src;
    document.body.style.overflow = 'hidden';
    
    // Gérer les touches du clavier
    document.addEventListener('keydown', handleKeyPress);
  }

  function closeModal() {
    const modal = document.getElementById('imageModal');
    modal.style.display = "none";
    document.body.style.overflow = 'auto';
    document.removeEventListener('keydown', handleKeyPress);
  }

  function changeImage(direction) {
    const modalImg = document.getElementById('modalImage');
    
    // Ajouter une classe pour l'animation de fondu
    modalImg.style.opacity = '0';
    
    setTimeout(() => {
      currentImageIndex = (currentImageIndex + direction + galleryImages.length) % galleryImages.length;
      modalImg.src = galleryImages[currentImageIndex];
      modalImg.style.opacity = '1';
    }, 300);
  }

  function handleKeyPress(event) {
    switch(event.key) {
      case 'ArrowLeft':
        changeImage(-1);
        break;
      case 'ArrowRight':
        changeImage(1);
        break;
      case 'Escape':
        closeModal();
        break;
    }
  }

  // Configuration Disqus
  var disqus_config = function () {
    this.page.url = "{{ site.url }}{{ page.url }}";
    this.page.identifier = "{{ page.url }}";
    this.page.title = "{{ page.title }}";
  };

  (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://{{ site.disqus.shortname }}.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Veuillez activer JavaScript pour voir les <a href="https://disqus.com/?ref_noscript">commentaires propulsés par Disqus.</a></noscript>